{"title":"Untitled","markdown":{"yaml":{"title":"Untitled","author":"Diego Lizcano, Alejandra Bonilla","date":"`r Sys.Date()`","output":"html_document"},"headingText":"cargar paquetes","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n\n```{r}\nlibrary(knitr)\nlibrary(tidyverse) # manejad datos\nlibrary(mapview) # mapas facil\nlibrary(readxl) #leer datos\nlibrary(sf) # vector map\nlibrary(geodata) #replace getData de raster para Terra\nlibrary(raster)\nlibrary(spatstat)\nlibrary(maptools) # to coerce to ppp. note that 'maptools' will be retired by the end of 2023\n# library(stars)\nlibrary(unmarked)\n\n\nsource(\"D:/BoxFiles/Box Sync/CodigoR/tigrinus/R/organizadato.R\")\n\n```\n\n# UCUMARI\n\n## cargar datos\n\n```{r}\n\n\nFull_data_ucu <- read_excel(\"D:/BoxFiles/Box Sync/CodigoR/tigrinus/data/Full_data_Ucumari_Huila_Cocha1_Cocha2.xlsx\", \n    sheet = \"ucumari\", col_types = c(\"numeric\", \n        \"text\", \"text\", \"text\", \"text\", \"text\", \n        \"text\", \"text\", \"text\", \"text\", \"text\", \n        \"text\", \"text\", \"text\", \"text\", \"numeric\", \n        \"text\", \"text\", \"text\", \"text\", \"text\", \n        \"text\", \"text\", \"text\", \"text\", \"numeric\", \n        \"numeric\", \"numeric\", \"numeric\", \n        \"text\"))\n\n\n\n```\n\n## crerar matrices para unmarked\n\n```{r}\n\ncasas <- read_csv(\"D:/BoxFiles/Box Sync/CodigoR/tigrinus/data/casas.csv\")\ncasas_sf <- st_as_sf(casas, coords = c(\"lon\", \"lat\"), crs = \"EPSG:4326\")\n\n\n\n\n############# start spatial part\n#### make sf object\nucumari_sf <- st_as_sf(Full_data_ucu, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n\n# get centroid. 1st bbox, make pol\ncentroid_ucu <- st_centroid(st_as_sfc(st_bbox(ucumari_sf)))\n# get altitude\nelev_ucu_full <- elevation_3s(centroid_ucu[[1]][1], centroid_ucu[[1]][2], \n                         path=\"D:/BoxFiles/Box Sync/CodigoR/tigrinus/raster\")\n\n# elev_ucu_full_ras <- elev_ucu_full %>% raster()\n\n# st_bbox(ucumari_sf) # notice order xmin, xmax, ymin, ymax\next_ucu <- ext(-75.59, -75.47,  4.68,    4.81 )\nelev_ucu <- crop(elev_ucu_full, ext_ucu) \n\n# convert from terra to raster\nelev_ucu_ras <-  elev_ucu %>% raster()\n\n# get uniques\ncams_ucu <-Full_data_ucu %>% dplyr::select(c(\"Longitude\", \"Latitude\", \"camera_trap\")) %>% distinct()\n#### make sf object\ncams_ucu_sf <- st_as_sf(cams_ucu, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n# extract values from raster using altitude\ncams_ucu_sf$elev <- extract(elev_ucu_ras, cams_ucu_sf)\n\n############## make distance map\n# Convert points to sp spatialpointdatafram\ncasas_points <- as(casas_sf, \"Spatial\")\n# Projection\n# Be sure to have rgdal first installed.\ncasas_points_utm <- spTransform(casas_points, CRS('+init=epsg:32718'))\n# convert to ppp\ncasas_points_ppp <- as(as(casas_points_utm, \"SpatialPoints\"), \"ppp\")\n# distance\ncasas_distance <- distmap(casas_points_ppp)\n\n####### extract distance \n\ncasas_distance_ras<- raster(casas_distance) # convert raster\ncrs(casas_distance_ras) <- '+init=epsg:32718' # add crs\n\n# project raster\ncasa_distance <- projectRaster(casas_distance_ras, crs = crs(casas_points))\n\n# cams_ucu_sf$dist_casa <- raster::extract(casas_distance_ras, cams_ucu_sf)\ncams_ucu_sf$dist_casa <- raster::extract(casa_distance, cams_ucu_sf) # also works\n\n\n# plot map\nmapview(elev_ucu_ras) + mapview(cams_ucu_sf[\"camera_trap\"]) \n\n############### end spatial part\n\nFull_data_ucu$binomial <- str_c (Full_data_ucu$Genus, \"_\", Full_data_ucu$Species)\n\n#funcion para crear todas las tablas de datos\nall_data <-  f.matrix.creator2 (Full_data_ucu)\n# names(all_data) # ver lass especies y en que lista esta cada una\nkable(names(all_data)) # html table\n# Tigrinus es lista 8\n\n\n\n```\n\n## unmarked\n\n```{r}\n\n# tabla con solo tiginus\ntigrinus_ucu <- all_data[[8]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_tigrinus_ucu <- unmarkedFrameOccu(y=tigrinus_ucu)\n# verificar datos en grafica\n# plot(umf_tigrinus_ucu)\n\n# tabla con solo perros\nperros_ucu <- all_data[[75]]\n# crear objeto umf\numf_perros_ucu <- unmarkedFrameOccu(y=perros_ucu)\n# verificar datos en grafica\n# plot(umf_perros_ucu)\n\n# tabla con solo ocelote\nocelote_ucu <- all_data[[16]]\n# crear objeto umf\numf_ocelote_ucu <- unmarkedFrameOccu(y=ocelote_ucu)\n# verificar datos en grafica\n# plot(umf_ocelote_ucu)\n\n```\n\n## Modelo nulo\n\n```{r}\n# modelo nulo tigrinus\nfm_tig_ucu <- occu(~1 ~1, umf_tigrinus_ucu)  # fit a model\n\nbackTransform(fm_tig_ucu, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_ucu, type=\"state\") # estimado linel de ocupacion\n\n# modelo nulo perro\nfm_perros_ucu <- occu(~1 ~1, umf_perros_ucu)  # fit a model\n\nbackTransform(fm_perros_ucu, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_perros_ucu, type=\"state\") # estimado linel de ocupacion\n\n# modelo nulo ocelote\nfm_ocelote_ucu <- occu(~1 ~1, umf_ocelote_ucu)  # fit a model\n\nbackTransform(fm_ocelote_ucu, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_ocelote_ucu, type=\"state\") # estimado linel de ocupacion\n\n\n```\n\n## MODELOS DE CO-OCURRENCIA\n\n```{r}\n\ndetformulas <- c( \"~1\", \"~1\")#, \"~1\")\n#stateformulas <- c('~elev','~elev', '~elev', \"~1\", \"~1\", \"~1\", \"~0\")# 3 sp\nstateformulas <- c('~elev','~elev', \"~0\")\ny <- list(tigrinus_ucu, perros_ucu)# , ocelote_ucu)\nnames(y) <- c(\"tigrinus\", \"perros\")#, \"ocelote\")\n\n\nobs_covs <-as.data.frame(scale(cams_ucu_sf$dist_casa))\nnames(obs_covs) <- \"dist_casa\"\n\nsite_covs <- data.frame(cams_ucu_sf[,c('elev','dist_casa')])[,1:2]\nsite_covs <-as.data.frame(apply(site_covs,2,scale))\nnames(site_covs) <- c(\"elev\", \"dist_casa\")\n\n\numf <-  unmarkedFrameOccuMulti(y=y, \n                              siteCovs=site_covs,\n                              obsCovs = NULL)\nplot(umf)\n#umf\n\n# occFormulas Length should match number/order of columns in fDesign\numf@fDesign\n\n\nfit1 <- occuMulti(detformulas, stateformulas, umf,    \n        method=\"BFGS\", se=TRUE, engine=c(\"C\"), silent=FALSE)\n\nfit1\n\n# update model\n# occFormulas2 <- c('~dist_casa', '~dist_casa', '~dist_casa', \"~1\", \"~1\", \"~1\", \"~0\")\noccFormulas2 <- c('~dist_casa', '~dist_casa', \"~0\")\nfit2 <- update(fit1, stateformulas=occFormulas2)\nfit2\n\n#List of fitted models\nfl <- fitList(fit1, fit2)\ncoef(fl)\n\n#Model selection\nmodSel(fl)\n\nbt <- parboot(fit1, nsim=50) # takes time\nplot(bt)\n\n```\n\n## plot predicted marginal occupancy\n\n```{r}\n#Plot predicted marginal occupancy as a function of disturbance\nr <- range(cams_ucu_sf$elev)\nx1 <- seq(r[1],r[2],length.out=100)\nx_scale <- (x1-mean(cams_ucu_sf$elev))/sd(cams_ucu_sf$elev)\n\nr2 <- range(cams_ucu_sf$dist_casa)\nx2 <- seq(r2[1],r2[2],length.out=100)\nx2_scale <- (x2-mean(cams_ucu_sf$dist_casa))/sd(cams_ucu_sf$dist_casa)\n\nnd <- matrix(NA, 100, 2)\nnd <- data.frame(elev=x_scale, dist_casa= x2_scale)\n\n\n\ntigrinus_pred <- predict(fit1, \"state\", species=\"tigrinus\", newdata=nd)\ntigrinus_pred$Species <- \"tigrinus\"\n\nperros_pred <- predict(fit1, \"state\", species=\"perros\", newdata=nd)\nperros_pred$Species <- \"perros\"\n\n# ocelote_pred <- predict(fit2, \"state\", species=\"ocelote\", newdata=nd)\n# ocelote_pred$Species <- \"ocelote\"\n\n\nplot_dat <- rbind(tigrinus_pred, perros_pred)#, ocelote_pred)\n\nggplot(data=plot_dat, aes(x=rep(x1,2), y=Predicted)) + # change to 3 sp and x2 to distance\n  geom_ribbon(aes(ymin=lower, ymax=upper, fill=Species), alpha=0.3) +\n  geom_line(aes(col=Species)) +\n  labs(x=\"Elevation\", y=\"Marginal occupancy\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),\n        axis.text=element_text(size=12), axis.title=element_text(size=14),\n        legend.text=element_text(size=12), legend.title=element_text(size=14))\n\n\n\n```\n\n## plot predicted co-occurrence occupancy\n\n```{r}\n#Plot predicted marginal occupancy as a function of disturbance\nr <- range(cams_ucu_sf$elev)\nx1 <- seq(r[1],r[2],length.out=100)\nx_scale <- (x1-mean(cams_ucu_sf$elev))/sd(cams_ucu_sf$elev)\n\nr2 <- range(cams_ucu_sf$dist_casa)\nx2 <- seq(r2[1],r2[2],length.out=100)\nx2_scale <- (x2-mean(cams_ucu_sf$dist_casa))/sd(cams_ucu_sf$dist_casa)\n\nnd <- matrix(NA, 100, 2)\nnd <- data.frame(elev=x_scale, dist_casa= x2_scale)\n\n\ntigrinus_perros_pred <- predict(fit1, \"state\", \n                         species=c(\"tigrinus\", \"perros\"), newdata=nd)\n\n# tigrinus_pred$Species <- c(\"tigrinus\", \"perros\")\n\n# perros_pred <- predict(fit1, \"state\", species=\"perros\", newdata=nd)\n# perros_pred$Species <- \"perros\"\n\n# ocelote_pred <- predict(fit2, \"state\", species=\"ocelote\", newdata=nd)\n# ocelote_pred$Species <- \"ocelote\"\n\n\nplot_dat <- tigrinus_perros_pred #rbind(tigrinus_pred, perros_pred)#, ocelote_pred)\n\nggplot(data=plot_dat, aes(x=rep(x1), y=Predicted)) + # change to 3 sp and x2 to distance\n  geom_ribbon(aes(ymin=lower, ymax=upper, fill = \"grey50\"), alpha=0.3) +\n  geom_line(aes(y=Predicted), col=\"blue\") +\n  labs(x=\"Elevation\", y=\"co-occurence\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),\n        axis.text=element_text(size=12), axis.title=element_text(size=14),\n        legend.text=element_text(size=12), legend.title=element_text(size=14))\n\n\n\n```\n\n\n## plot predicted conditional occupancy \n\n```{r}\n#Plot predicted marginal occupancy as a function of disturbance\nr <- range(cams_ucu_sf$elev)\nx1 <- seq(r[1],r[2],length.out=100)\nx_scale <- (x1-mean(cams_ucu_sf$elev))/sd(cams_ucu_sf$elev)\n\nr2 <- range(cams_ucu_sf$dist_casa)\nx2 <- seq(r2[1],r2[2],length.out=100)\nx2_scale <- (x2-mean(cams_ucu_sf$dist_casa))/sd(cams_ucu_sf$dist_casa)\n\nnd <- matrix(NA, 100, 2)\nnd <- data.frame(elev=x_scale, dist_casa= x2_scale)\n\n##### conditional\n\ntigrinus_perro_no <- predict(fit1, \"state\", \n                         species=\"tigrinus\", \n                         cond='-perros',\n                         newdata=nd)\n\ntigrinus_perro_no$Species <- \"perro ausente\"\n\ntigrinus_perro_si <- predict(fit1, \"state\", \n                         species=\"tigrinus\", \n                         cond='perros',\n                         newdata=nd)\n\ntigrinus_perro_si$Species <- \"perro presente\"\n\n\n\n\n\n# perros_pred <- predict(fit1, \"state\", species=\"perros\", newdata=nd)\n# perros_pred$Species <- \"perros\"\n\n# ocelote_pred <- predict(fit2, \"state\", species=\"ocelote\", newdata=nd)\n# ocelote_pred$Species <- \"ocelote\"\n\n\nplot_dat <- rbind(tigrinus_perro_si, tigrinus_perro_no)#, ocelote_pred)\n\nggplot(data=plot_dat, aes(x=rep(x1,2), y=Predicted)) + # change to 3 sp and x2 to distance\n  geom_ribbon(aes(ymin=lower, ymax=upper, fill=Species), alpha=0.3) +\n  geom_line(aes(col=Species)) +\n  labs(x=\"Elevation\", y=\"tigrinus conditional occupancy\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),\n        axis.text=element_text(size=12), axis.title=element_text(size=14),\n        legend.text=element_text(size=12), legend.title=element_text(size=14))\n\n\n\n```\n\n\n\n\n\n\n# JUNTANDO TODOS LOS DATOS\n\n\n\n```{r}\nlibrary(readxl)\ntotal <- read_delim(\"C:/CodigoR/tigrinus2/data/total.csv\", delim = \";\", escape_double = FALSE, trim_ws = TRUE)\n\n\n```\n\n## crerar matrices para unmarked\n\n```{r}\n#funcion para crear todas las tablas de datos\nall_data_total <-  f.matrix.creator2 (total)\nnames(all_data_total) # ver lass especies y en que lista esta cada una\n# Tigrinus es lista 7\n\n\n#code to shrink the matrix to exactly 150 columns: Aprox una semana\nf.shrink.matrix.to150<-function(matrix){\n  nc<-dim(matrix)[2]\n  if(!nc%%150){ # of the number of columns is exactly divisible by 15\n    newc<-nc%/%150\n    old.cols<-seq(1,nc,newc)\n    new.matrix<-matrix(NA,nr=nrow(matrix),nc=150)\n    for(i in 1:150){\n      new.matrix[,i]<-apply(matrix[,old.cols[i]:(old.cols[i]+newc-1)],1,max,na.rm=T)\n    }\n  } else{\n    rem<-nc%%150\n    newc<-nc%/%150\n    old.cols<-seq(1,nc-rem,newc)\n    new.matrix<-matrix(NA,nr=nrow(matrix),nc=150)\n    for(i in 1:149)\n      new.matrix[,i]<-apply(matrix[,old.cols[i]:(old.cols[i]+newc-1)],1,max,na.rm=T)\n    new.matrix[,150]<-apply(matrix[,old.cols[150]:nc],1,max,na.rm=T) \n  }\n  new.matrix[new.matrix==\"-Inf\"]<-NA\n  rownames(new.matrix)<-rownames(matrix)\n  new.matrix\n}\n\n\n\n\n# tabla con solo tiginus\ntigrinus_total <- all_data_total[[7]]\n\n# colapsa a una semana take tima\ntigrinus_150<-f.shrink.matrix.to150(matrix = all_data_total[[7]])\n\n\n# crear objeto umf\numf_tigrinus_total <- unmarkedFrameOccu(y=tigrinus_150)\n# verificar datos en grafica\nplot(umf_tigrinus_total)\n\n\n\n\n```\n\n\n\n\n\n\n\n\n\n\n# LAGUNA DE LA COCHA\n\n```{r}\n\nlibrary(readr)\ncocha1_data <- read_excel(\"C:/CodigoR/tigrinus2/data/Full_data_Ucumari_Huila_Cocha1_Cocha2.xlsx\", \n    sheet = \"cocha1\")\n\ncocha2_data <- read_excel(\"C:/CodigoR/tigrinus2/data/Full_data_Ucumari_Huila_Cocha1_Cocha2.xlsx\", \n    sheet = \"cocha2\")\n\ncocha2_data$binomial <- str_c (cocha2_data$Genus, \"_\", cocha2_data$Species)\n\n\n\n\n```\n\n## crerar matrices para unmarked\n\n```{r}\n\n############# start spatial part\n#### make sf object\ncocha1_sf <- st_as_sf(cocha1_data, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n#### make sf object\ncocha2_sf <- st_as_sf(cocha2_data, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n\n# get centroid. 1st bbox, make pol\ncentroid_cocha <- st_centroid(st_as_sfc(st_bbox(cocha1_sf)))\n# get altitude\nelev_cocha_full <- elevation_3s(centroid_cocha[[1]][1], centroid_cocha[[1]][2], \n                         path=\"C:/CodigoR/tigrinus2/raster\")\n\n# elev_ucu_full_ras <- elev_ucu_full %>% raster()\n\n# st_bbox(ucumari_sf) # notice order xmin, xmax, ymin, ymax\next_cocha <- ext(-77.17, -77.05,  0.886,    1.085 )\nelev_cocha <- crop(elev_cocha_full, ext_cocha) \n\n# convert from terra to raster\nelev_cocha_ras <-  elev_cocha %>% raster()\n\n##### get uniques\ncams_cocha1 <-cocha1_data %>% dplyr::select(c(\"Longitude\", \"Latitude\", \"camera_trap\")) %>% distinct()\n#### make sf object\ncams_cocha1_sf <- st_as_sf(cams_cocha1, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\ncams_cocha2 <-cocha2_data %>% dplyr::select(c(\"Longitude\", \"Latitude\", \"camera_trap\")) %>% distinct()\n#### make sf object\ncams_cocha2_sf <- st_as_sf(cams_cocha2, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n\n\n# extract values from raster using altitude\ncams_cocha1_sf$elev <- extract(elev_cocha_ras, cams_cocha1_sf)\ncams_cocha2_sf$elev <- extract(elev_cocha_ras, cams_cocha2_sf)\n\n\n############## make distance map\n# # Convert points to sp spatialpointdatafram\n# casas_points <- as(casas_sf, \"Spatial\")\n# # Projection\n# # Be sure to have rgdal first installed.\n# casas_points_utm <- spTransform(casas_points, CRS('+init=epsg:32718'))\n# # convert to ppp\n# casas_points_ppp <- as(as(casas_points_utm, \"SpatialPoints\"), \"ppp\")\n# # distance\n# casas_distance <- distmap(casas_points_ppp)\n\n####### extract distance \n# \n# casas_distance_ras<- raster(casas_distance) # convert raster\n# crs(casas_distance_ras) <- '+init=epsg:32718' # add crs\n# \n# # project raster\n# casa_distance <- projectRaster(casas_distance_ras, crs = crs(casas_points))\n\n\n# extracr raster values\n# cams_ucu_sf$dist_casa <- raster::extract(casas_distance_ras, cams_ucu_sf)\ncams_cocha1_sf$dist_casa <- raster::extract(casa_distance, cams_cocha1_sf) # also works\ncams_cocha2_sf$dist_casa <- raster::extract(casa_distance, cams_cocha2_sf) # also works\n\n\n# plot map\nmapview(elev_cocha_ras) + mapview(cams_cocha1_sf[\"camera_trap\"]) + mapview(cams_cocha2_sf[\"camera_trap\"]) \n\n############### end spatial part\n\n# fix cocha2 data\n# cocha2_data$binomial <- str_c (cocha2_data$Genus, \"_\", cocha2_data$Species)\n\n#funcion para crear todas las tablas de datos\nall_data_cocha1 <-  f.matrix.creator2 (cocha1_data)\nall_data_cocha2 <-  f.matrix.creator2 (cocha2_data)\n# names(all_data) # ver lass especies y en que lista esta cada una\nkable(names(all_data_cocha1)) # html table\n# Tigrinus es lista 11 y perro 2\n\nkable(names(all_data_cocha2)) # html table\n# Tigrinus es 30\n# Perro no hay\n\n\n```\n\n## unmarked\n\n```{r}\n# tabla con solo tiginus\ntigrinus_cocha1 <- all_data_cocha1[[11]]\ntigrinus_cocha2 <- all_data_cocha2[[30]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_tigrinus_cocha1 <- unmarkedFrameOccu(y=tigrinus_cocha1)\numf_tigrinus_cocha2 <- unmarkedFrameOccu(y=tigrinus_cocha2)\n# verificar datos en grafica\nplot(umf_tigrinus_cocha1)\nplot(umf_tigrinus_cocha2)\n\n\n# tabla con solo perro\nperros_cocha1 <- all_data_cocha1[[2]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_perros_cocha1 <- unmarkedFrameOccu(y=perros_cocha1)\n# verificar datos en grafica\nplot(umf_perros_cocha1)\n\n\n```\n\n## Modelo nulo\n\n```{r}\n\n# modelo nulo\nfm_tig_cocha1 <- occu(~1 ~1, umf_tigrinus_cocha1)  # fit a model\nfm_tig_cocha2 <- occu(~1 ~1, umf_tigrinus_cocha2)  # fit a model\n\nbackTransform(fm_tig_cocha1, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_cocha1, type=\"state\") # estimado linel de ocupacion\n\nbackTransform(fm_tig_cocha2, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_cocha2, type=\"state\") # estimado linel de ocupacion\n\n# modelo nulo\nfm_perros_cocha1 <- occu(~1 ~1, umf_perros_cocha1)  # fit a model\n\nbackTransform(fm_perros_cocha1, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_perros_cocha1, type=\"state\") # estimado linel de ocupacion\n\n\n```\n\n\n## MODELOS DE CO-OCURRENCIA\n\n```{r}\n\ndetformulas <- c( \"~1\", \"~1\")#, \"~1\")\n#stateformulas <- c('~elev','~elev', '~elev', \"~1\", \"~1\", \"~1\", \"~0\")# 3 sp\nstateformulas <- c('~elev','~elev', \"~0\")\ny <- list(tigrinus_cocha1, perros_cocha1)# , ocelote_ucu)\nnames(y) <- c(\"tigrinus\", \"perros\")#, \"ocelote\")\n\n\nobs_covs <-as.data.frame(scale(cams_cocha1_sf$dist_casa))\nnames(obs_covs) <- \"dist_casa\"\n\nsite_covs <- data.frame(cams_cocha1_sf[,c('elev','dist_casa')])[,1:2]\nsite_covs <-as.data.frame(apply(site_covs,2,scale))\nnames(site_covs) <- c(\"elev\", \"dist_casa\")\n\n\numf <-  unmarkedFrameOccuMulti(y=y, \n                              siteCovs=site_covs,\n                              obsCovs = NULL)\nplot(umf)\n#umf\n\n# occFormulas Length should match number/order of columns in fDesign\numf@fDesign\n\n\nfit1 <- occuMulti(detformulas, stateformulas, umf,    \n        method=\"BFGS\", se=TRUE, engine=c(\"C\"), silent=FALSE)\n\nfit1\n\n# update model\n# occFormulas2 <- c('~dist_casa', '~dist_casa', '~dist_casa', \"~1\", \"~1\", \"~1\", \"~0\")\noccFormulas2 <- c('~dist_casa', '~dist_casa', \"~0\")\nfit2 <- update(fit1, stateformulas=occFormulas2)\nfit2\n\n#List of fitted models\nfl <- fitList(fit1, fit2)\ncoef(fl)\n\n#Model selection\nmodSel(fl)\n\nbt <- parboot(fit2, nsim=50) # takes time\nplot(bt)\n\n```\n\n## plot predicted marginal occupancy\n\n```{r}\n#Plot predicted marginal occupancy as a function of disturbance\nr <- range(cams_cocha1_sf$elev)\nx1 <- seq(r[1],r[2],length.out=100)\nx_scale <- (x1-mean(cams_cocha1_sf$elev))/sd(cams_cocha1_sf$elev)\n\nr2 <- range(cams_cocha1_sf$dist_casa)\nx2 <- seq(r2[1],r2[2],length.out=100)\nx2_scale <- (x2-mean(cams_cocha1_sf$dist_casa))/sd(cams_cocha1_sf$dist_casa)\n\nnd <- matrix(NA, 100, 2)\nnd <- data.frame(elev=x_scale, dist_casa= x2_scale)\n\n\n\ntigrinus_pred <- predict(fit2, \"state\", species=\"tigrinus\", newdata=nd)\ntigrinus_pred$Species <- \"tigrinus\"\n\nperros_pred <- predict(fit2, \"state\", species=\"perros\", newdata=nd)\nperros_pred$Species <- \"perros\"\n\n# ocelote_pred <- predict(fit2, \"state\", species=\"ocelote\", newdata=nd)\n# ocelote_pred$Species <- \"ocelote\"\n\n\nplot_dat <- rbind(tigrinus_pred, perros_pred)#, ocelote_pred)\n\nggplot(data=plot_dat, aes(x=rep(x1,2), y=Predicted)) + # change to 3 sp and x2 to distance\n  geom_ribbon(aes(ymin=lower, ymax=upper, fill=Species), alpha=0.3) +\n  geom_line(aes(col=Species)) +\n  labs(x=\"Elevation\", y=\"Marginal occupancy\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),\n        axis.text=element_text(size=12), axis.title=element_text(size=14),\n        legend.text=element_text(size=12), legend.title=element_text(size=14))\n\n\n\n```\n\n\n## plot predicted co-occurrence occupancy\n\n```{r}\n#Plot predicted marginal occupancy as a function of disturbance\nr <- range(cams_cocha1_sf$elev)\nx1 <- seq(r[1],r[2],length.out=100)\nx_scale <- (x1-mean(cams_cocha1_sf$elev))/sd(cams_cocha1_sf$elev)\n\nr2 <- range(cams_ucu_sf$dist_casa)\nx2 <- seq(r2[1],r2[2],length.out=100)\nx2_scale <- (x2-mean(cams_cocha1_sf$dist_casa))/sd(cams_cocha1_sf$dist_casa)\n\nnd <- matrix(NA, 100, 2)\nnd <- data.frame(elev=x_scale, dist_casa= x2_scale)\n\n\ntigrinus_perros_pred <- predict(fit2, \"state\", \n                         species=c(\"tigrinus\", \"perros\"), newdata=nd)\n\n# tigrinus_pred$Species <- c(\"tigrinus\", \"perros\")\n\n# perros_pred <- predict(fit1, \"state\", species=\"perros\", newdata=nd)\n# perros_pred$Species <- \"perros\"\n\n# ocelote_pred <- predict(fit2, \"state\", species=\"ocelote\", newdata=nd)\n# ocelote_pred$Species <- \"ocelote\"\n\n\nplot_dat <- tigrinus_perros_pred #rbind(tigrinus_pred, perros_pred)#, ocelote_pred)\n\nggplot(data=plot_dat, aes(x=rep(x1), y=Predicted)) + # change to 3 sp and x2 to distance\n  geom_ribbon(aes(ymin=lower, ymax=upper, fill = \"grey50\"), alpha=0.3) +\n  geom_line(aes(y=Predicted), col=\"blue\") +\n  labs(x=\"Elevation\", y=\"co-occurence\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),\n        axis.text=element_text(size=12), axis.title=element_text(size=14),\n        legend.text=element_text(size=12), legend.title=element_text(size=14))\n\n\n\n```\n\n\n## plot predicted conditional occupancy \n\n```{r}\n#Plot predicted marginal occupancy as a function of disturbance\nr <- range(cams_cocha1_sf$elev)\nx1 <- seq(r[1],r[2],length.out=100)\nx_scale <- (x1-mean(cams_cocha1_sf$elev))/sd(cams_cocha1_sf$elev)\n\nr2 <- range(cams_cocha1_sf$dist_casa)\nx2 <- seq(r2[1],r2[2],length.out=100)\nx2_scale <- (x2-mean(cams_cocha1_sf$dist_casa))/sd(cams_cocha1_sf$dist_casa)\n\nnd <- matrix(NA, 100, 2)\nnd <- data.frame(elev=x_scale, dist_casa= x2_scale)\n\n##### conditional\n\ntigrinus_perro_no <- predict(fit2, \"state\", \n                         species=\"tigrinus\", \n                         cond='-perros',\n                         newdata=nd)\n\ntigrinus_perro_no$Species <- \"perro ausente\"\n\ntigrinus_perro_si <- predict(fit2, \"state\", \n                         species=\"tigrinus\", \n                         cond='perros',\n                         newdata=nd)\n\ntigrinus_perro_si$Species <- \"perro presente\"\n\n\n\n\n\n# perros_pred <- predict(fit1, \"state\", species=\"perros\", newdata=nd)\n# perros_pred$Species <- \"perros\"\n\n# ocelote_pred <- predict(fit2, \"state\", species=\"ocelote\", newdata=nd)\n# ocelote_pred$Species <- \"ocelote\"\n\n\nplot_dat <- rbind(tigrinus_perro_si, tigrinus_perro_no)#, ocelote_pred)\n\nggplot(data=plot_dat, aes(x=rep(x1,2), y=Predicted)) + # change to 3 sp and x2 to distance\n  geom_ribbon(aes(ymin=lower, ymax=upper, fill=Species), alpha=0.3) +\n  geom_line(aes(col=Species)) +\n  labs(x=\"Elevation\", y=\"tigrinus conditional occupancy\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),\n        axis.text=element_text(size=12), axis.title=element_text(size=14),\n        legend.text=element_text(size=12), legend.title=element_text(size=14))\n\n\n\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## LA FE COMPLETO (2021-2022)\n\n```{r eval=FALSE}\n\nlafe_comp_full_data <- read_excel(\"D:/BoxFiles/Box Sync/CodigoR/tigrinus/data/cuencaverde.xlsx\",   sheet = \"LaFe_completo\")\n\nlafe_comp_full_data_sf <- st_as_sf(lafe_comp_full_data, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n# View\n# mapview(lafe_comp_full_data_sf, zcol=\"camera_trap\") \n\n\n```\n\n# crerar matrices para unmarked\n\n```{r eval=FALSE}\n#funcion para crear todas las tablas de datos\nall_data <-  f.matrix.creator2 (lafe_comp_full_data)\nnames(all_data) # ver lass especies y en que lista esta cada una\n\n```\n\n# unmarked\n\n```{r eval=FALSE}\n# tabla con solo tiginus\ntigrinus_fecom <- all_data[[3]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_tigrinus_fecom <- unmarkedFrameOccu(y=tigrinus_fecom)\n# verificar datos en grafica\nplot(umf_tigrinus_fecom)\n\n\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_tig_fecom <- occu(~1 ~1, umf_tigrinus_fecom)  # fit a model\n\nbackTransform(fm_tig_fecom, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_fecom, type=\"state\") # estimado linel de ocupacion\n\n```\n\n```{r eval=FALSE}\n# tabla con solo perros\nperros_fecom <- all_data[[2]]\n# crear objeto umf\numf_perros_fecom <- unmarkedFrameOccu(y=perros_fecom)\n# verificar datos en grafica\nplot(umf_perros_fecom)\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_perros_fecom <- occu(~1 ~1, umf_perros_fecom)  # fit a model\n\nbackTransform(fm_perros_fecom, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_perros_fecom, type=\"state\") # estimado linel de ocupacion\n```\n\n# cargar datos\n\n## LA FE (2021)\n\n```{r eval=FALSE}\n\nlafe_comp_full_data2 <- read_excel(\"D:/BoxFiles/Box Sync/CodigoR/tigrinus/data/cuencaverde.xlsx\",   sheet = \"LaFe_2021\")\n\nlafe_comp_full_data_sf2 <- st_as_sf(lafe_comp_full_data2, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n\n```\n\n# crerar matrices para unmarked\n\n```{r eval=FALSE}\n#funcion para crear todas las tablas de datos\nall_data <-  f.matrix.creator2 (lafe_comp_full_data)\nnames(all_data) # ver lass especies y en que lista esta cada una\n\n```\n\n# unmarked\n\n```{r eval=FALSE}\n# tabla con solo tiginus\ntigrinus_fe <- all_data[[3]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_tigrinus_fe <- unmarkedFrameOccu(y=tigrinus_fe)\n# verificar datos en grafica\nplot(umf_tigrinus_fe)\n\n\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_tig_fe <- occu(~1 ~1, umf_tigrinus_fe)  # fit a model\n\nbackTransform(fm_tig_fe, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_fe, type=\"state\") # estimado linel de ocupacion\n\n```\n\n```{r eval=FALSE}\n# tabla con solo perros\nperros_fe <- all_data[[2]]\n# crear objeto umf\numf_perros_fe <- unmarkedFrameOccu(y=perros_fe)\n# verificar datos en grafica\nplot(umf_perros_fe)\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_perros_fe <- occu(~1 ~1, umf_perros_fe)  # fit a model\n\nbackTransform(fm_perros_fe, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_perros_fe, type=\"state\") # estimado linel de ocupacion\n```\n\n# cargar datos\n\n# RIOGRANDE COMPLETO (2021-2022)\n\n```{r eval=FALSE}\n\nRG_comp_full_data <- read_excel(\"D:/BoxFiles/Box Sync/CodigoR/tigrinus/data/cuencaverde.xlsx\",   sheet = \"Riogrande_completo\")\n\nRG_comp_full_data_sf <- st_as_sf(RG_comp_full_data, coords = c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n\n\n```\n\n# crerar matrices para unmarked\n\n```{r eval=FALSE}\n#funcion para crear todas las tablas de datos\nall_data <-  f.matrix.creator2 (RG_comp_full_data)\nnames(all_data) # ver lass especies y en que lista esta cada una\n\n```\n\n# unmarked\n\n```{r eval=FALSE}\n# tabla con solo tiginus\ntigrinus_RGcom <- all_data[[11]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_tigrinus_RGcom <- unmarkedFrameOccu(y=tigrinus_RGcom)\n# verificar datos en grafica\nplot(umf_tigrinus_RGcom)\n\n\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_tig_RGcom <- occu(~1 ~1, umf_tigrinus_RGcom)  # fit a model\n\nbackTransform(fm_tig_RGcom, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_RGcom, type=\"state\") # estimado linel de ocupacion\n\n```\n\n```{r eval=FALSE}\n# tabla con solo perros\nperros_RGcom <- all_data[[1]]\n# crear objeto umf\numf_perros_RGcom <- unmarkedFrameOccu(y=perros_RGcom)\n# verificar datos en grafica\nplot(umf_perros_RGcom)\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_perros_RGcom <- occu(~1 ~1, umf_perros_RGcom)  # fit a model\n\nbackTransform(fm_perros_RGcom, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_perros_RGcom, type=\"state\") # estimado linel de ocupacion\n```\n\n# cargar datos\n\nLA RG (2021)\n\n```{r eval=FALSE}\n\nRG_comp_full_data <- read_excel(\"D:/Documentos/ARTICULOS 2023/TIGRINUS/data/cuencaverde.xlsx\",   sheet = \"Riogrande_2021\")\n\n\n\n```\n\n# crerar matrices para unmarked\n\n```{r eval=FALSE}\n#funcion para crear todas las tablas de datos\nall_data <-  f.matrix.creator2 (RG_comp_full_data)\nnames(all_data) # ver lass especies y en que lista esta cada una\n\n```\n\n# unmarked\n\n```{r eval=FALSE}\n# tabla con solo tiginus\ntigrinus_RG <- all_data[[11]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_tigrinus_RG <- unmarkedFrameOccu(y=tigrinus_RG)\n# verificar datos en grafica\nplot(umf_tigrinus_RG)\n\n\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_tig_RG <- occu(~1 ~1, umf_tigrinus_RG)  # fit a model\n\nbackTransform(fm_tig_RG, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_RG, type=\"state\") # estimado linel de ocupacion\n\n```\n\n```{r eval=FALSE}\n# tabla con solo perros\nperros_RG <- all_data[[1]]\n# crear objeto umf\numf_perros_RG <- unmarkedFrameOccu(y=perros_RG)\n# verificar datos en grafica\nplot(umf_perros_RG)\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_perros_RG <- occu(~1 ~1, umf_perros_RG)  # fit a model\n\nbackTransform(fm_perros_RG, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_perros_RG, type=\"state\") # estimado linel de ocupacion\n```\n\n# cargar datos\n\nPITALITO\n\n```{r eval=FALSE}\n\npitalito_data <- read_excel(\"D:/Documentos/ARTICULOS 2023/TIGRINUS/data/Full_data_Ucumari_Huila_Cocha1_Cocha2.xlsx\", \nsheet = \"pitalito\")\n\n\n\n```\n\n# crerar matrices para unmarked\n\n```{r eval=FALSE}\n#funcion para crear todas las tablas de datos\nall_data_pit <-  f.matrix.creator2 (pitalito_data)\nnames(all_data_pit) # ver lass especies y en que lista esta cada una\n\n```\n\n# unmarked\n\n```{r eval=FALSE}\n# tabla con solo tiginus\ntigrinus_pit <- all_data_pit[[6]]\n# cargar paquete\nlibrary(unmarked)\n# crear objeto umf\numf_tigrinus_pit <- unmarkedFrameOccu(y=tigrinus_pit)\n# verificar datos en grafica\nplot(umf_tigrinus_pit)\n\n\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_tig_pit <- occu(~1 ~1, umf_tigrinus_pit)  # fit a model\n\nbackTransform(fm_tig_pit, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_tig_pit, type=\"state\") # estimado linel de ocupacion\n\n```\n\n```{r eval=FALSE}\n# tabla con solo perros\nperros_pit <- all_data_pit[[43]]\n# crear objeto umf\numf_perros_pit <- unmarkedFrameOccu(y=perros_pit)\n# verificar datos en grafica\nplot(umf_perros_pit)\n```\n\n```{r eval=FALSE}\n# modelo nulo\nfm_perros_pit <- occu(~1 ~1, umf_perros_pit)  # fit a model\n\nbackTransform(fm_perros_pit, type=\"det\") #estimado lineal de deteccion\nbackTransform(fm_perros_pit, type=\"state\") # estimado linel de ocupacion\n```\n\nMODELOS DE CO-OCURRENCIA\n\nCOCHA1\n\n```{r eval=FALSE}\nlibrary(unmarked)\ndetformulas <- c('~1','~1')\nstateformulas <- c('~1','~1', '~1')\ny <- list(tigrinus_co1,perros_co1)\nnames(y) <- c(\"tigrinus\", \"perros\")\n\ndata = unmarkedFrameOccuMulti(y=y)\n```\n\n```{r eval=FALSE}\nfit <- occuMulti(detformulas, stateformulas, data,  penalty=0, boot=30, \n        method=\"BFGS\", se=TRUE, engine=c(\"C\",\"R\"), silent=FALSE)\n```\n\nco-ocurrencia\n\n```{r eval=FALSE}\n#probability of co-occurrence of two or more species\nhead(predict(fit, 'state'))\n\n```\n\n```{r eval=FALSE}\n#detección\nhead(predict(fit, 'det'))\n```\n\n```{r eval=FALSE}\nlibrary(boot)\noccu_estimate <- fit@estimates@estimates$state@estimates\noccu <- as.data.frame(inv.logit(occu_estimate))\noccu\n```\n\n```{r eval=FALSE}\ndet_estimate <- fit@estimates@estimates$det@estimates\ndet <- (inv.logit(det_estimate))\ndet\n```\n\nMODELOS DE CO-OCURRENCIA\n\nLA FE completo\n\n```{r eval=FALSE}\nlibrary(unmarked)\ndetformulas <- c('~1','~1')\nstateformulas <- c('~1','~1', '~1')\ny <- list(tigrinus_fecom,perros_fecom)\nnames(y) <- c(\"tigrinus\", \"perros\")\n\ndata = unmarkedFrameOccuMulti(y=y)\n```\n\n```{r eval=FALSE}\nfit <- occuMulti(detformulas, stateformulas, data,  penalty=0, boot=30, \n        method=\"BFGS\", se=TRUE, engine=c(\"C\",\"R\"), silent=FALSE)\n```\n\nProbabilidad de tigrinus estar presente si los perros están presentes\n\n```{r eval=FALSE}\nhead(predict(fit,'state',species='tigrinus',cond='perros'))\n```\n\nProbabilidad de tigrinus estar presente si los perros están ausentes\n\n```{r eval=FALSE}\nhead(predict(fit,'state',species='tigrinus',cond='-perros'))\n```\n\n```{r eval=FALSE}\n#detección\nhead(predict(fit, 'det'))\n```\n\n```{r eval=FALSE}\nlibrary(boot)\noccu_estimate <- fit@estimates@estimates$state@estimates\noccu <- as.data.frame(inv.logit(occu_estimate))\noccu\n```\n\n```{r eval=FALSE}\ndet_estimate <- fit@estimates@estimates$det@estimates\ndet <- (inv.logit(det_estimate))\ndet\n```\n\nMODELOS DE CO-OCURRENCIA\n\nLA FE 2021\n\n```{r eval=FALSE}\nlibrary(unmarked)\ndetformulas <- c('~1','~1')\nstateformulas <- c('~1','~1', '~1')\ny <- list(tigrinus_fe,perros_fe)\nnames(y) <- c(\"tigrinus\", \"perros\")\n\ndata = unmarkedFrameOccuMulti(y=y)\n```\n\n```{r eval=FALSE}\nfit <- occuMulti(detformulas, stateformulas, data,  penalty=0, boot=30, \n        method=\"BFGS\", se=TRUE, engine=c(\"C\",\"R\"), silent=FALSE)\n```\n\nProbabilidad de tigrinus estar presente si los perros están presentes\n\n```{r eval=FALSE}\nhead(predict(fit,'state',species='tigrinus',cond='perros'))\n```\n\nProbabilidad de tigrinus estar presente si los perros están ausentes\n\n```{r eval=FALSE}\nhead(predict(fit,'state',species='tigrinus',cond='-perros'))\n```\n\n```{r eval=FALSE}\n#detección\nhead(predict(fit, 'det'))\n```\n\n```{r eval=FALSE}\nlibrary(boot)\noccu_estimate <- fit@estimates@estimates$state@estimates\noccu <- as.data.frame(inv.logit(occu_estimate))\noccu\n```\n\n```{r eval=FALSE}\ndet_estimate <- fit@estimates@estimates$det@estimates\ndet <- (inv.logit(det_estimate))\ndet\n```\n\nMODELOS DE CO-OCURRENCIA\n\nRG completo\n\n```{r eval=FALSE}\nlibrary(unmarked)\ndetformulas <- c('~1','~1')\nstateformulas <- c('~1','~1', '~1')\ny <- list(tigrinus_RGcom,perros_RGcom)\nnames(y) <- c(\"tigrinus\", \"perros\")\n\ndata = unmarkedFrameOccuMulti(y=y)\n```\n\n```{r eval=FALSE}\nfit <- occuMulti(detformulas, stateformulas, data,  penalty=0, boot=30, \n        method=\"BFGS\", se=TRUE, engine=c(\"C\",\"R\"), silent=FALSE)\n```\n\nProbabilidad de tigrinus estar presente si los perros están presentes\n\n```{r eval=FALSE}\nhead(predict(fit,'state'))\n```\n\n```{r eval=FALSE}\n#detección\nhead(predict(fit, 'det'))\n```\n\n```{r eval=FALSE}\nlibrary(boot)\noccu_estimate <- fit@estimates@estimates$state@estimates\noccu <- as.data.frame(inv.logit(occu_estimate))\noccu\n```\n\n```{r eval=FALSE}\ndet_estimate <- fit@estimates@estimates$det@estimates\ndet <- (inv.logit(det_estimate))\ndet\n```\n\nMODELOS DE CO-OCURRENCIA\n\nLA RG 2021\n\n```{r eval=FALSE}\nlibrary(unmarked)\ndetformulas <- c('~1','~1')\nstateformulas <- c('~1','~1', '~1')\ny <- list(tigrinus_RG,perros_RG)\nnames(y) <- c(\"tigrinus\", \"perros\")\n\ndata = unmarkedFrameOccuMulti(y=y)\n```\n\n```{r eval=FALSE}\nfit <- occuMulti(detformulas, stateformulas, data,  penalty=0, boot=30, \n        method=\"BFGS\", se=TRUE, engine=c(\"C\",\"R\"), silent=FALSE)\n```\n\nProbabilidad de tigrinus estar presente si los perros están presentes\n\n```{r eval=FALSE}\nhead(predict(fit,'state'))\n```\n\n```{r eval=FALSE}\n#detección\nhead(predict(fit, 'det'))\n```\n\n```{r eval=FALSE}\nlibrary(boot)\noccu_estimate <- fit@estimates@estimates$state@estimates\noccu <- as.data.frame(inv.logit(occu_estimate))\noccu\n```\n\n```{r eval=FALSE}\ndet_estimate <- fit@estimates@estimates$det@estimates\ndet <- (inv.logit(det_estimate))\ndet\n```\n\nMODELOS DE CO-OCURRENCIA\n\nPITALITO\n\n```{r eval=FALSE}\nlibrary(unmarked)\ndetformulas <- c('~1','~1')\nstateformulas <- c('~1','~1', '~1')\ny <- list(tigrinus_pit,perros_pit)\nnames(y) <- c(\"tigrinus\", \"perros\")\n\ndata = unmarkedFrameOccuMulti(y=y)\n```\n\n```{r eval=FALSE}\nfit <- occuMulti(detformulas, stateformulas, data,  penalty=0, boot=30, \n        method=\"BFGS\", se=TRUE, engine=c(\"C\",\"R\"), silent=FALSE)\n```\n\nProbabilidad de tigrinus estar presente si los perros están presentes\n\n```{reval=FALSE }\nhead(predict(fit,'state'))\n```\n\n```{r eval=FALSE}\n#detección\nhead(predict(fit, 'det'))\n```\n\n```{r eval=FALSE}\nlibrary(boot)\noccu_estimate <- fit@estimates@estimates$state@estimates\noccu <- as.data.frame(inv.logit(occu_estimate))\noccu\n```\n\n```{r eval=FALSE}\ndet_estimate <- fit@estimates@estimates$det@estimates\ndet <- (inv.logit(det_estimate))\ndet\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html_document","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"ensayo1_alejandra.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","editor":"visual","theme":"cosmo","title":"Untitled","author":"Diego Lizcano, Alejandra Bonilla","date":"`r Sys.Date()`"},"extensions":{"book":{"multiFile":true}}}}}